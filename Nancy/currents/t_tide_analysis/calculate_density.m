function rho = calculate_density(t, s)
% Calculate the density give temperature t in deg C and salinity s in PSU.
% Based on Susam's fortran script.

    rho = ...
        999.842594 + 6.793952e-2 * t ...
        - 9.095290e-3 * t.*t + 1.001685e-4 * t.*t.*t ...
        - 1.120083e-6 * t.*t.*t.*t + 6.536332e-9 * t.*t.*t.*t.*t ...
        + 8.24493e-1 * s - 4.0899e-3 * t.*s ...
        + 7.6438e-5 * t.*t.*s - 8.2467e-7 * t.*t.*t.*s ...
        + 5.3875e-9 * t.*t.*t.*t.*s - 5.72466e-3 * s.^1.5 ...
        + 1.0227e-4 * t.*s.^1.5 - 1.6546e-6 * t.*t.*s.^1.5 ...
        + 4.8314e-4 * s.*s ;
        

end